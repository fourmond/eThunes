<?xml version="1.0" encoding="UTF-8"?>
<collection-definition>
  <!-- Comment -->
  <document-type name="avis">
    <display-format>Avis de %{mois%date:MM/yyyy} pour %{identifiant}</display-format>
  </document-type>
  <ruby-class-code module-name="Assedic">
    <code><![CDATA[
module Assedic
  def self.parse_avis(doc)
    res = {}
    if doc['text'] =~ /Identifiant\s*:\s*(\S+)/
      res['identifiant'] = $1
    end
    if doc['text'] =~ /mois\s+d(?:e\s|')\s*(\S+)\s+(\d+)/
      res['mois'] = Time.local($2.to_i, Dates::parse_french_month($1))
    end
    if doc['text'] =~ /le\s+(\d+)\/(\d+)\/(\d+)\s+\S+\s+(\d+):(\d+)/
      res['enregistrement'] = Time.local($3.to_i + 2000, $2.to_i, $1.to_i, $4.to_i, $5.to_i)
    end
    return res
  end
end
]]>
    </code>
  </ruby-class-code>
</collection-definition>
